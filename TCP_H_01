DECLARE
  i INT64 DEFAULT 1;
DECLARE
  R INT64 DEFAULT cast(floor(rand()*100)+1 as INT64);
WHILE
  i <= 100 DO
  -- Query 1
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	test-187010.TPCH.lineitem
where
	l_shipdate <=    DATE_ADD(DATE "1998-11-19",INTERVAL 1 DAY) 
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus
LIMIT 1;
SET
  i = i + 1;
SET
  R= cast(floor(rand()*100)+1 as INT64);
END WHILE
  ;
